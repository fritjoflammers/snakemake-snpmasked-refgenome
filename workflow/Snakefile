import glob
import os
from snakemake.remote.FTP import RemoteProvider as FTPRemoteProvider
from snakemake.remote.HTTP import RemoteProvider as HTTPRemoteProvider

FTP = FTPRemoteProvider(username="anonymous", password="mypassword")
HTTP = HTTPRemoteProvider()

print(config)

STRAINS = config["strains"]
PER_STRAIN_FASTA = config["per_strain_fasta"]

all_files = [
    "output/all_SNPs_{strain}_GRCm38.bed.gz".format(strain=strain)
    for strain in config.get("strains")
] + [
    "output/all_SNPs_all_strains_GRCm38.bed.gz",
    "output/GRCm38_masked_all_strains"
]
if PER_STRAIN_FASTA:
    all_files.extend(["output/GRCm38_masked_{strain}".format(strain=strain)
                         for strain in config.get("strains")])

print(all_files)


localrules:
    all,
    snp_split_concat,
    rename_fasta_header,
    rename_gtf_names


rule all:
    input:
        all_files,


# rule retrieve_snp_vcf:
#    #    input: HTTP.remote("ftp.sanger.ac.uk/pub/REL-1505-SNPs_Indels/mgp.v5.merged.snps_all.dbSNP142.vcf.gz", keep_local=True)
#    output: "data/mgp.v5.merged.snps_all.dbSNP142.vcf.gz"
#    run:
# 	print("File is there {output}")

include: "rules/prepare.smk"
include: "rules/maskfasta.smk"
include: "rules/cellranger_mkref.smk"
